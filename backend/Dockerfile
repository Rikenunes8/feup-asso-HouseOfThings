# syntax=docker/dockerfile:1
FROM python:3.11.2-alpine3.17
WORKDIR /app/backend/
COPY . /app/backend/
RUN pip install -r requirements.txt

ARG MONGODB_USERNAME
ENV MONGODB_USERNAME=$MONGODB_USERNAME
ARG MONGODB_PASSWORD
ENV MONGODB_PASSWORD=$MONGODB_PASSWORD
ARG MONGODB_HOSTNAME
ENV MONGODB_HOSTNAME=$MONGODB_HOSTNAME
ARG MONGODB_PORT
ENV MONGODB_PORT=$MONGODB_PORT
ARG MONGODB_DATABASE
ENV MONGODB_DATABASE=$MONGODB_DATABASE

ARG MQTT_BROKER
ENV MQTT_BROKER=$MQTT_BROKER
ARG MQTT_PORT
ENV MQTT_PORT=$MQTT_PORT
ARG MQTT_USERNAME
ENV MQTT_USERNAME=$MQTT_USERNAME
ARG MQTT_PASSWORD
ENV MQTT_PASSWORD=$MQTT_PASSWORD

ENTRYPOINT [ "sh", "./start.sh" ]
CMD ["python3", "app.py"]